<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function computes the asymptotic inflation and variance of the MLE of a binary regression
when both \(n\) and \(p\) are large,
assuming that covariates \(X\) are multivariate Gaussian."><title>Adjust the MLE in a binary regression — adjust_binary • glmhd</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adjust the MLE in a binary regression — adjust_binary"><meta property="og:description" content="This function computes the asymptotic inflation and variance of the MLE of a binary regression
when both \(n\) and \(p\) are large,
assuming that covariates \(X\) are multivariate Gaussian."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">glmhd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/glmboot.html">A resized bootstrap method for high-dimensional GLMs</a>
    <a class="dropdown-item" href="../articles/incorrect-model.html">Estimating the distribution of the M-estimator of a general loss function</a>
    <a class="dropdown-item" href="../articles/my-vignette.html">glmhd: statistical inference in high-dimensional binary regression</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/zq00/glmhd/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Adjust the MLE in a binary regression</h1>
      <small class="dont-index">Source: <a href="https://github.com/zq00/glmhd/blob/HEAD/R/adjust_binary.R" class="external-link"><code>R/adjust_binary.R</code></a></small>
      <div class="d-none name"><code>adjust_binary.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes the asymptotic inflation and variance of the MLE of a binary regression
when both \(n\) and \(p\) are large,
assuming that covariates \(X\) are multivariate Gaussian.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">adjust_binary</span><span class="op">(</span><span class="va">glm_output</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, echo <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>glm_output</dt>
<dd><p>An object from the class <code>glm</code>,
for example the output from the <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> function</p></dd>


<dt>verbose</dt>
<dd><p>If <code>TRUE</code>, print progress at every step.</p></dd>


<dt>echo</dt>
<dd><p>If <code>TRUE</code>, return the input <code>glm_output</code>.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with elements</p><dl><dt>glm_output</dt>
<dd><p>If <code>echo = TRUE</code>, returns the input <code>glm_output</code>.</p></dd>

<dt>gamma_hat</dt>
<dd><p>Estimated signal strength \(\gamma_0\).</p></dd>

<dt>param</dt>
<dd><p>Estimated paramters \((\alpha_\star, \lambda_\star, \sigma_\star, b_\star)\).
   If the model does not contain an intercept, returns \((\alpha_\star, \lambda_\star, \sigma_\star)\).</p></dd>

<dt>intercept</dt>
<dd><p>Does the model contain an intercept?</p></dd>

<dt>tau_hat</dt>
<dd><p>Estimated conditional standard deviation.</p></dd>

<dt>coef_adj</dt>
<dd><p>Adjusted MLE: this is \(\hat{\beta}^{\mathrm{MLE}} / \alpha_\star\).</p></dd>

<dt>std_adj</dt>
<dd><p>Estimated standard error of \(\hat{\beta}_j\): \(\sigma_\star / \tau_j\).</p></dd>

<dt>coef_unadj</dt>
<dd><p>Unadjusted MLE.</p></dd>

<dt>std_unadj</dt>
<dd><p>Unadjusted standard error. This is output from the <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> function.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function estimates coefficients of a binary regression by adjusting the MLE
based on the theory when \(n\) and \(p\) grows to infinity, and the covariates are multivariate Gaussian.
In this setting, the MLE of one variable \(\beta_j\) is
$$
\hat{\beta}^{\mathrm{MLE}}_j - \alpha_\star \beta_j \approx \mathcal{N}(0, \sigma_\star^2 / \tau_j^2).
$$
where \(\tau_j^2\) is the conditional variance of \(x_j\) given all the other variables.
This implies \(\hat{\beta}_j^\mathrm{Adj} = \hat{\beta}^{MLE}_j / \alpha_\star\) is unbiased for the coefficient \(\beta_j\).
<code>adjust_binary</code> computes \(\hat{\beta}_j^\mathrm{Adj}\) and returns it in the vector <code>coef_adj</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="additional-arguments">Additional arguments<a class="anchor" aria-label="anchor" href="#additional-arguments"></a></h2>
    

<dl><dt>B</dt>
<dd><p>Number of repetitions at each <code>kappa</code> in <em>ProbeFrontier</em> algorithm.</p></dd>

    <dt>tol</dt>
<dd><p><code>tol</code> parameter when solving for signal strength and intercept. see <code>signal_strength</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a></h2>
    

<ul><li><p>The variables should be centered to have zero mean.</p></li>
<li><p>The input to this function should be an object from the class <code>glm</code>,
  and it should include <code>family</code> specifying the link function. Currently, the algorithm
  can handle logit and probit link.</p></li>
<li><p>if estimated \(\hat{\gamma}&lt;0.0001\), we set \(\gamma=0\).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><em>The Asymptotic Distribution of the MLE in High-dimensional Logistic Models: Arbitrary Covariance</em>, Qian Zhao, Pragya Sur and Emmanuel J. Candes, arXiv:2001.09351</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Problem size</span></span>
<span class="r-in"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000L</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">300L</span></span>
<span class="r-in"><span class="co"># Generate data matrix</span></span>
<span class="r-in"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Sample parameters</span></span>
<span class="r-in"><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">p</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span>
<span class="r-in"><span class="co"># Generate response</span></span>
<span class="r-in"><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fl">0</span>, family <span class="op">=</span> <span class="va">binomial</span>, x <span class="op">=</span> <span class="cn">TRUE</span>, y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">adjusted_fit</span> <span class="op">&lt;-</span> <span class="fu">adjust_binary</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function:  logit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------ Begin Probe Frontior ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kappa =  0.405 ; pi_hat =  0.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kappa =  0.4575 ; pi_hat =  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kappa =  0.43125 ; pi_hat =  0.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kappa =  0.418125 ; pi_hat =  0.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kappa =  0.4115625 ; pi_hat =  0.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kappa =  0.4148438 ; pi_hat =  0.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kappa =  0.4132031 ; pi_hat =  0.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kappa =  0.4123828 ; pi_hat =  0.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Found kappa_s =  0.4097962 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Finding signal strength and the intercept -- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  No intercept, estimated signal strength gamma_hat =  1.267636 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Found parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  alpha_s lambda_s  sigma_s </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.766048 4.471162 2.795273 </span>
<span class="r-in"><span class="co"># Adjusted MLE</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">adjusted_fit</span><span class="op">$</span><span class="va">coef_unadj</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        X1        X2        X3        X4        X5        X6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.044095  1.215670  3.915436  6.992635 -5.281657  9.027532 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Qian Zhao.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

