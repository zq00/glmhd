<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This is the generic function and methods associated with the adjusted MLE for
high dimensional generalized linear models (glm)."><title>Estimate coefficients of a high-dimensional GLM — adjust_glm • glmhd</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate coefficients of a high-dimensional GLM — adjust_glm"><meta property="og:description" content="This is the generic function and methods associated with the adjusted MLE for
high dimensional generalized linear models (glm)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">glmhd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/glmboot.html">A resized bootstrap method for high-dimensional GLMs</a>
    <a class="dropdown-item" href="../articles/incorrect-model.html">Estimating the distribution of the M-estimator of a general loss function</a>
    <a class="dropdown-item" href="../articles/my-vignette.html">glmhd: statistical inference in high-dimensional binary regression</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/zq00/glmhd/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Estimate coefficients of a high-dimensional GLM</h1>
      <small class="dont-index">Source: <a href="https://github.com/zq00/glmhd/blob/HEAD/R/glmmod.R" class="external-link"><code>R/glmmod.R</code></a></small>
      <div class="d-none name"><code>adjust_glm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is the generic function and methods associated with the adjusted MLE for
high dimensional generalized linear models (glm).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">adjust_glm</span><span class="op">(</span><span class="va">glm_output</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, echo <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>glm_output</dt>
<dd><p>An object from the class <a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a>,
for example the output from the <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> function</p></dd>


<dt>verbose</dt>
<dd><p>If <code>TRUE</code>, print progress at every step.</p></dd>


<dt>echo</dt>
<dd><p>If <code>TRUE</code>, returns the original <code>glm_output</code>.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function <code>adjust_glm</code> is built on the <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> function: the input should be from the
class <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code>, such as the output from <code>glm</code>.
Currently, it works with binary regressions only, for which it calls the function <code>adjust_binary</code>
to estimate coefficients and their standard deviations. In high dimensions,
the magnitude of MLE is biased upward, and the variance estimates from classical theory based on
inverse Fisher information underestimates the true variability. <code>adjust_binary</code> adjusts the MLE and variance estimates
applying the asymptotic theory assuming \(p, n\to\infty\) (\(p&lt;n\)), and is exact when
covariates \(X\) is multivariate Gaussian.</p>
<p><code>adjust_glm</code> creates an object from class <code>glmadj</code>. <code>summary.glmadj</code> creates a data table of adjusted coefficients,
estimates of the standard error and p-values using a two-sided t-test. If
the covariates are multivariate Gaussian, the p-values are asymptotically
from a uniform distribution.</p>
<p><code>predict.glmadj</code> computes the prediction \(X^\top \hat{\beta}^{\mathrm{Adj}}\) for
new input data. The new data should be of the same format which you
used to fit the <code>glm</code>. If there's no new data, it outputs the estimated
\(X^\top \hat{\beta}_{\mathrm{Adj}}\) for the original dataset.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="adjust_binary.html">adjust_binary</a></code> <code><a href="glmadj.html">print.glmadj</a></code>
    <code><a href="glmadj.html">summary.glmadj</a></code> <code><a href="glmadj.html">predict.glmadj</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Problem size</span></span>
<span class="r-in"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000L</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">300L</span></span>
<span class="r-in"><span class="co"># Generate data matrix</span></span>
<span class="r-in"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Generate parameters</span></span>
<span class="r-in"><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">p</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span>
<span class="r-in"><span class="co">#' ## No intercept model</span></span>
<span class="r-in"><span class="co"># Sample response vector</span></span>
<span class="r-in"><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Fit a glm, by default computes a logistic regression</span></span>
<span class="r-in"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fl">0</span>, family <span class="op">=</span> <span class="va">binomial</span>, x <span class="op">=</span> <span class="cn">TRUE</span>, y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">adjusted_fit</span> <span class="op">&lt;-</span> <span class="fu">adjust_glm</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Print summary</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adjusted_fit</span><span class="op">)</span>, max <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjust_glm(glm_output = fit)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      adjusted_mle         std z.value   p.value    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1    -0.00847596  0.09080651 -0.0933 0.9256328    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2     0.08228799  0.09158411  0.8985 0.3689210    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3     0.00225270  0.09113093  0.0247 0.9802788    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4     0.12776741  0.08180704  1.5618 0.1183317    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X5     0.12208436  0.09093356  1.3426 0.1794124    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X6     0.14182345  0.09224081  1.5375 0.1241624    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X7     0.16738694  0.09266929  1.8063 0.0708742 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X8     0.26618628  0.08890818  2.9939 0.0027539 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 292 rows ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span class="co"># Predict on new data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">adjusted_fit</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  2.36189042  1.55461876 -1.53630085 -0.03311306 -1.12050853  2.36940721</span>
<span class="r-in"><span class="co"># Extract adjusted coefficients</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">adjusted_fit</span><span class="op">$</span><span class="va">coef_adj</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           X1           X2           X3           X4           X5           X6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.008475955  0.082287991  0.002252704  0.127767408  0.122084356  0.141823446 </span>
<span class="r-in"><span class="co"># Extract adjusted standard error</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">adjusted_fit</span><span class="op">$</span><span class="va">std_adj</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        X1        X2        X3        X4        X5        X6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1575873 0.1589367 0.1581503 0.1419694 0.1578077 0.1600764 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Qian Zhao.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

