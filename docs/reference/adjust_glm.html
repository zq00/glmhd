<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate coefficients of a high-dimensional GLM — adjust_glm • glmhd</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimate coefficients of a high-dimensional GLM — adjust_glm" />
<meta property="og:description" content="This is the generic function and methods associated with the adjusted MLE for
high dimensional generalized linear models (glm)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmhd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/my-vignette.html">glmhd: statistical inference in high-dimensional binary regression</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/zq00/glmhd/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate coefficients of a high-dimensional GLM</h1>
    <small class="dont-index">Source: <a href='https://github.com/zq00/glmhd/blob/master/R/glmmod.R'><code>R/glmmod.R</code></a></small>
    <div class="hidden name"><code>adjust_glm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is the generic function and methods associated with the adjusted MLE for
high dimensional generalized linear models (glm).</p>
    </div>

    <pre class="usage"><span class='fu'>adjust_glm</span>(<span class='no'>glm_output</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>echo</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>glm_output</th>
      <td><p>An object from the class <a href='https://rdrr.io/r/stats/glm.html'>glm</a>,
for example the output from the <code><a href='https://rdrr.io/r/stats/glm.html'>glm</a></code> function</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>If <code>TRUE</code>, print progress at every step.</p></td>
    </tr>
    <tr>
      <th>echo</th>
      <td><p>If <code>TRUE</code>, returns the original <code>glm_output</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function <code>adjust_glm</code> is built on the <code><a href='https://rdrr.io/r/stats/glm.html'>glm</a></code> function: the input should be from the
class <code><a href='https://rdrr.io/r/stats/glm.html'>glm</a></code>, such as the output from <code>glm</code>.
Currently, it works with binary regressions only, for which it calls the function <code>adjust_binary</code>
to estimate coefficients and their standard deviations. In high dimensions,
the magnitude of MLE is biased upward, and the variance estimates from classical theory based on
inverse Fisher information underestimates the true variability. <code>adjust_binary</code> adjusts the MLE and variance estimates
applying the asymptotic theory assuming \(p, n\to\infty\) (\(p&lt;n\)), and is exact when
covariates \(X\) is multivariate Gaussian.</p>
<p><code>adjust_glm</code> creates an object from class <code>glmadj</code>. <code>summary.glmadj</code> creates a data table of adjusted coefficients,
estimates of the standard error and p-values using a two-sided t-test. If
the covariates are multivariate Gaussian, the p-values are asymptotically
from a uniform distribution.</p>
<p><code>predict.glmadj</code> computes the prediction \(X^\top \hat{\beta}^{\mathrm{Adj}}\) for
new input data. The new data should be of the same format which you
used to fit the <code>glm</code>. If there's no new data, it outputs the estimated
\(X^\top \hat{\beta}_{\mathrm{Adj}}\) for the original dataset.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='adjust_binary.html'>adjust_binary</a></code> <code><a href='glmadj.html'>print.glmadj</a></code>
    <code><a href='glmadj.html'>summary.glmadj</a></code> <code><a href='glmadj.html'>predict.glmadj</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Problem size</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>1000L</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fl'>300L</span>
<span class='co'># Generate data matrix</span>
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>*<span class='no'>p</span>, <span class='fl'>0</span>, <span class='fl'>1</span>), <span class='no'>n</span>, <span class='no'>p</span>)
<span class='co'># Generate parameters</span>
<span class='no'>beta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>), <span class='no'>p</span> / <span class='fl'>2</span>) / <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>p</span>) * <span class='fl'>2</span>
<span class='co'>#' ## No intercept model</span>
<span class='co'># Sample response vector</span>
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='no'>n</span>, <span class='fl'>1</span>, <span class='fl'>1</span> / (<span class='fl'>1</span> + <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(- <span class='no'>X</span> <span class='kw'>%*%</span> <span class='no'>beta</span>)))
<span class='co'># Fit a glm, by default computes a logistic regression</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span>(<span class='no'>Y</span> ~ <span class='no'>X</span> + <span class='fl'>0</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='no'>binomial</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>adjusted_fit</span> <span class='kw'>&lt;-</span> <span class='fu'>adjust_glm</span>(<span class='no'>fit</span>)
<span class='co'># Print summary</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>adjusted_fit</span>), <span class='kw'>max</span> <span class='kw'>=</span> <span class='fl'>40</span>)</div><div class='output co'>#&gt; Call:
#&gt; adjust_glm(glm_output = fit)
#&gt; 
#&gt;      adjusted_mle        std z.value   p.value    
#&gt; X1     -0.0191088  0.0958177 -0.1994 0.8419275    
#&gt; X2      0.2634231  0.0996318  2.6440 0.0081941 ** 
#&gt; X3      0.1436590  0.0943073  1.5233 0.1276819    
#&gt; X4      0.2569481  0.0940849  2.7310 0.0063138 ** 
#&gt; X5     -0.1776332  0.0931093 -1.9078 0.0564179 .  
#&gt; X6      0.2309281  0.0953822  2.4211 0.0154744 *  
#&gt; X7      0.1740878  0.0949737  1.8330 0.0668012 .  
#&gt; X8      0.1010892  0.0996689  1.0143 0.3104632    
#&gt;  [ reached getOption("max.print") -- omitted 292 rows ]
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'><span class='co'># Predict on new data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>adjusted_fit</span>))</div><div class='output co'>#&gt; [1]  1.1646301  0.1507479 -4.0982981 -0.7192127  1.8776390 -0.3789456</div><div class='input'><span class='co'># Extract adjusted coefficients</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>adjusted_fit</span>$<span class='no'>coef_adj</span>)</div><div class='output co'>#&gt;          X1          X2          X3          X4          X5          X6 
#&gt; -0.01910879  0.26342309  0.14365901  0.25694813 -0.17763325  0.23092806 </div><div class='input'><span class='co'># Extract adjusted standard error</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>adjusted_fit</span>$<span class='no'>std_adj</span>)</div><div class='output co'>#&gt;        X1        X2        X3        X4        X5        X6 
#&gt; 0.1765595 0.1835876 0.1737765 0.1733665 0.1715689 0.1757570 </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Qian Zhao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


